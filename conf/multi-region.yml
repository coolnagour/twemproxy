# Example: Multi-region Redis with zone preference
# This configuration handles multiple regions with intelligent zone routing

global:
    worker_processes: auto
    max_openfiles: 102400
    user: nobody
    group: nobody
    worker_shutdown_timeout: 30

pools:
    # Primary region cache (high same-AZ preference)
    us_east_cache:
        listen: 127.0.0.1:6379
        auto_eject_hosts: true
        redis: true
        timeout: 2000
        server_retry_timeout: 5000
        server_failure_limit: 2
        server_connections: 1

        # Strong same-AZ preference for primary region
        zone_aware: true
        zone_weight: 85             # 85% same-AZ traffic
        dns_resolve_interval: 20

        connection_pooling: true
        connection_warming: 2

        servers:
            - us-east-redis-ro.cache.amazonaws.com:6379:1

    # Backup region cache (moderate AZ preference)
    us_west_cache:
        listen: 127.0.0.1:6380
        auto_eject_hosts: true
        redis: true
        timeout: 3000               # Higher timeout for cross-region
        server_retry_timeout: 10000
        server_failure_limit: 3
        server_connections: 1

        # Moderate same-AZ preference for backup region
        zone_aware: true
        zone_weight: 60             # 60% same-AZ, 40% distributed
        dns_resolve_interval: 60    # Less frequent DNS checks

        connection_pooling: true
        connection_warming: 1
        connection_idle_timeout: 600

        servers:
            - us-west-redis-ro.cache.amazonaws.com:6379:1

    # Global cache (minimal AZ preference for global distribution)
    global_cache:
        listen: 127.0.0.1:6381
        auto_eject_hosts: true
        redis: true
        timeout: 5000               # High timeout for global traffic
        server_retry_timeout: 15000
        server_failure_limit: 5
        server_connections: 1

        # Light same-AZ preference for global distribution
        zone_aware: true
        zone_weight: 40             # 40% same-AZ, 60% distributed globally
        dns_resolve_interval: 120   # Infrequent DNS checks for global

        connection_pooling: true
        connection_warming: 1
        connection_idle_timeout: 1200

        servers:
            - global-redis-ro.cache.amazonaws.com:6379:1